---
title: Coursework 1
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Big Data Analytics using R

- **Full Name:** Baran Buluttekin
- **Programme:** MSc Data Science
- **Student ID:** 13153116

1. Statistical learning methods 

For each of parts (a) through (d), indicate whether we would generally expect the performance of a flexible
statistical learning method to be better or worse than an inflexible method. Justify your answer. 

(a) The sample size n is extremely large, and the number of predictors p is small.  
(b) The number of predictors p is extremely large, and the number of observations n is small.   
(c) The relationship between the predictors and response is highly non-linear.  
(d) The variance of the error terms, i.e. σ2 = Var(ε), is extremely high.  

2. Descriptive analysis 

In a higher educational institution the comprehensive applied mathematics exam is comprised of two parts. On the first day, 20 students took the exam, the results of which are presented below:  

Oral exam results: 4, 1, 4, 5, 3, 2, 3, 4, 3, 5, 2, 2, 4, 3, 5, 5, 1, 1, 1, 2.  
Written exam results: 2,3,1,4,2,5,3,1,2,1,2,2,1,1,2,3,1,2,3,4.

(a) Use R to calculate the mean, the mode, the median, the variance and the standard deviation of the oral and written exams separately and together as well.  
```{r}
oral_exam <- c(4, 1, 4, 5, 3, 2, 3, 4, 3, 5, 2, 2, 4, 3, 5, 5, 1, 1, 1, 2)
written_exam <- c(2,3,1,4,2,5,3,1,2,1,2,2,1,1,2,3,1,2,3,4)
oral_mean <- mean(oral_exam)
written_mean <- mean(written_exam)
combined_mean <- mean(oral_exam + written_exam)
combined_mean
```
```{r}
written_mean <- mean(written_exam)
written_mean
```
```{r}
together_mean <- mean(oral_exam + written_exam)
together_mean
```

(b) Find the covariance and correlation between the oral and written exam scores.
```{r}
cor(oral_exam, written_exam)
```

(c) Is there a positive or negative or no correlation between the two? 

Its negative correlation.

(d) Is there causation between the two? Justify your answers.


3. Descriptive analysis 
This exercise involves the Auto data set studied in the class. Make sure that the missing values have been removed from the data.
(a) Which of the predictors are quantitative, and which are qualitative?

Let's examine the data with str() and look at the first 6 instances with head() function.
```{r}
library("ISLR")
str(Auto)
```
```{r}
head(Auto)
```
Auto$name: Nominal

Auto$cylinders: Ordial

Auto$displacement: Ratio

Auto$acceleration: Ratio

Auto$origin:Ordial

Auto$horsepower: Ratio

Auto$weight: Ratio

Auto$year: Interval

Auto$mpg: Ratio

Overall:

Qualitative: name, year, origin, cylinders

Quantitative: displacement, acceleration, horsepower, weight, mpg 

(b) What is the range of each quantitative predictor? You can answer this using the range() function.
```{r}
range(Auto$displacement)
```
```{r}
range(Auto$acceleration)
```
```{r}
range(Auto$horsepower)
```
```{r}
range(Auto$weight)
```
```{r}
range(Auto$mpg)
```

(c) What is the mean and standard deviation of each quantitative predictor?
```{r}
print(paste0("Mean: ", mean(Auto$displacement)))
print(paste0("Standard deviation: ", sd(Auto$displacement)))
```
```{r}
print(paste0("Mean: ", mean(Auto$acceleration)))
print(paste0("Standard deviation: ", sd(Auto$acceleration)))
```
```{r}
print(paste0("Mean: ", mean(Auto$horsepower)))
print(paste0("Standard deviation: ", sd(Auto$horsepower)))
```
```{r}
print(paste0("Mean: ", mean(Auto$weight)))
print(paste0("Standard deviation: ", sd(Auto$weight)))
```
```{r}
print(paste0("Mean: ", mean(Auto$mpg)))
print(paste0("Standard deviation: ", sd(Auto$mpg)))
```

(d) Now remove the 10th through 85th observations. What is the range, mean, and standard deviation of each predictor in the subset of the data that remains?  
```{r}
modified_Auto <- Auto[-c(10:85), ]
modified_Auto <- modified_Auto[c(1,3,4,5,6)]
colMeans(modified_Auto)
sapply(modified_Auto, sd)
```


(e) Using the full data set, investigate the predictors graphically, using scatterplots or other tools of your choice. Create some plots highlighting the relationships among the predictors. Comment on your findings.
(f) Suppose that we wish to predict gas mileage (mpg) on the basis of the other variables. Do your plots suggest that any of the other variables might be useful in predicting mpg? Justify your answer.

4. Linear regression 
This question involves the use of simple linear regression on the Auto data set.
(a) Use the lm() function to perform a simple linear regression with mpg as the response and horsepower as the predictor. Use the summary() function to print the results. Comment on the output. For example:

i. Is there a relationship between the predictor and the response?  

ii. How strong is the relationship between the predictor and the response?  

iii. Is the relationship between the predictor and the response positive or negative?  

iv. What is the predicted mpg associated with a horsepower of 98? What are the associated 95% confidence and prediction intervals?  

(b) Plot the response and the predictor. Use the abline() function to display the least squares regression line.  

(c) Plot the 95% confidence interval and prediction interval in the same plot as (b) using different colours and legends.  

5. Logistic regression
Using the Boston data set, fit classification models in order to predict whether a given suburb has a crime rate above or below the median. Explore logistic regression models using various subsets of the predictors. Describe your findings.  

6. Resampling methods  

Suppose that we use some statistical learning method to make a prediction for the response Y for a particular value of the predictor X. Carefully describe how we might estimate the standard deviation of our prediction.  

7. Resampling methods
We will now perform cross-validation on a simulated data set.  

(a) Generate a simulated data set as follows:  
```{r}
set.seed(500)
y = rnorm(500)
x = 4 - rnorm(500)
y = x - 2*x^2 + 3*x^4 + rnorm(500)
```

In this data set, what is n and what is p? Write out the model used to generate the data in equation form.

(b) Create a scatterplot of X against Y. Comment on what you find.  

(c) Set the seed to be 23, and then compute the LOOCV and 10-fold CV errors that result from fitting the following four models using least squares:
i. Y = β0 + β1X + ε
ii. Y =β0 +β1X+β2X2 +ε
iii. Y =β0 +β1X+β2X2 +β3X3 +ε
iv. Y =β0 +β1X+β2X2 +β3X3 +β4X4 +ε.  

Note you may find it helpful to use the data.frame() function to create a single data set containing both X and Y.  

(d) Repeat (c) using random seed 46, and report your results. Are your results the same as what you got in (c)? Why?  

(e) Which of the models in (c) had the smallest LOOCV and 10-fold CV error? Is this what you expected? Explain your answer.  

(f) Comment on the statistical significance of the coefficient estimates that results from fitting each of the models in (c) using least squares. Do these results agree with the conclusions drawn based on the cross-validation results?